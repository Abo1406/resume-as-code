# Automated CV Deployment with Ansible, Jenkins, and DigitalOcean

This repository contains the necessary Ansible playbooks and Jenkins pipeline definition to automatically deploy a personal CV/Resume as a static website hosted on a DigitalOcean Droplet.

## Overview

The goal of this project is to implement a "Resume-as-Code" approach. Instead of manually updating and uploading your CV to a server, this setup automates the entire process:

1.  **Infrastructure Provisioning:** Creates a new Droplet on DigitalOcean.
2.  **Web Server Setup:** Installs and configures an HTTPD (Apache) web server on the Droplet.
3.  **Content Deployment:** Places your CV file (formatted as `index.html`) onto the web server.
4.  **Service Management:** Ensures the web server is running with the latest changes.

This automation is orchestrated by a Jenkins pipeline that executes a series of Ansible playbooks.

## How it Works

The `Jenkinsfile` defines a CI/CD pipeline with the following stages:

1.  **Create the Droplet:** Executes `Ansible/digitalocean_droplet_setup.yml` to provision a new Droplet using the DigitalOcean API. Requires API token authentication via Ansible Vault.
2.  **Install HTTP on the Droplet:** Executes `Ansible/installs.yml` against the newly created Droplet (using the generated `Ansible/inven.ini` inventory) to install the HTTPD package.
3.  **Create CV file on HTTP main path:** Executes `Ansible/cv.yml` against the Droplet to copy or create the `index.html` file (your CV) in the web server's root directory. This playbook likely uses the `MyRESUME.pdf` as a source or expects the content to be defined within it.
4.  **Restart HTTPD:** Executes `Ansible/restart.yml` against the Droplet to restart the HTTPD service, making the `index.html` file accessible via the web.

## Project Structure
.
├── Ansible/
│   ├── cv.yml                     # Playbook to deploy the CV content as index.html
│   ├── digitalocean_droplet_setup.yml # Playbook to create the DO Droplet & inventory
│   ├── installs.yml               # Playbook to install HTTPD
│   ├── restart.yml                # Playbook to restart HTTPD service
│   └── secrets.yml                # (Needs to be created) Ansible Vault for DO token
├── .gitignore
├── Jenkinsfile                    # Jenkins declarative pipeline definition
└── MyRESUME.pdf                   # Source file for your CV (used by cv.yml)
*(Note: `Ansible/inven.ini` is dynamically generated by `digitalocean_droplet_setup.yml`)*

## Prerequisites

Before you can use this project, ensure you have the following:

1.  **DigitalOcean Account:** Required to create Droplets.
2.  **DigitalOcean API Token:** Generate a Personal Access Token with Read/Write permissions from your DigitalOcean account settings.
3.  **Ansible Installation:** Ansible needs to be installed on the machine or Jenkins agent executing the playbooks. The `digitalocean` collection might also be needed (`ansible-galaxy collection install community.digitalocean`).
4.  **Ansible Vault:** To securely store your API token (`secrets.yml`).
5.  **Jenkins Server:** A running Jenkins instance configured to run pipelines from SCM (like Git).
6.  **Git:** To clone this repository.
7.  **Password Authentication:** This setup relies on password authentication for Ansible to connect to the Droplet. The password is set during Droplet creation via the `digitalocean_droplet_setup.yml` playbook and stored temporarily in the generated `Ansible/inven.ini`. *(See Security Warning below)*.

## Setup

1.  **Clone the Repository:**
    ```bash
    git clone <your-repository-url>
    cd resume-as-code
    ```
2.  **Create Ansible Vault Secret:**
    Create an encrypted file to store your DigitalOcean API token. You will be prompted to set a vault password.
    ```bash
    ansible-vault create Ansible/secrets.yml
    ```
    Add the following content to the file (replace `YOUR_DO_API_TOKEN_HERE`):
    ```yaml
    do_api_token: YOUR_DO_API_TOKEN_HERE
    ```
    *Note:* The `digitalocean_droplet_setup.yml` playbook must be configured to load variables from this vault file. You might need to pass `--ask-vault-pass` or configure Jenkins credentials for the vault password when running the playbook.

3.  **Review Playbooks:** Check the Ansible playbooks (`.yml` files) and update variables if necessary (e.g., Droplet region, size, SSH key names in `digitalocean_droplet_setup.yml`, web server root path in `cv.yml`).

4.  **Update `MyRESUME.pdf`:** Place your actual CV content into `MyRESUME.pdf`. Ensure the `Ansible/cv.yml` playbook is correctly configured to process this file and create the desired `index.html`. You might need to modify `cv.yml` if you want to convert the PDF to HTML or use a different source format.

5.  **Configure Jenkins:**
    * Create a new Jenkins "Pipeline" job.
    * Configure the job to use "Pipeline script from SCM".
    * Set the SCM to "Git" and provide the repository URL.
    * Ensure the "Script Path" is `Jenkinsfile`.
    * **Crucially:** Update the absolute paths within the `Jenkinsfile` (`/root/resume-as-code/...`) to match the actual workspace path where Jenkins will check out the code on the agent node. Example: `${env.WORKSPACE}/Ansible/...`.
    * If using Ansible Vault password, configure Jenkins credentials to provide the vault password securely to the `ansible-playbook` commands (e.g., using the Credentials Binding plugin and environment variables).

## Usage

1.  **Run the Jenkins Job:** Trigger the Jenkins pipeline job you configured in the setup steps.
2.  **Monitor Pipeline:** Observe the stages executing in the Jenkins UI.
3.  **Access CV:** Once the pipeline completes successfully, the `digitalocean_droplet_setup.yml` playbook should output the IP address of the newly created Droplet (or you can find it in your DigitalOcean dashboard). Open a web browser and navigate to `http://<Droplet-IP-Address>` to view your deployed CV.

## CV Content

The source content for the CV is expected to be in `MyRESUME.pdf`. The `Ansible/cv.yml` playbook is responsible for taking this (or its content) and placing it as `index.html` in the web server's root directory (`/var/www/html` typically for Apache/HTTPD). You may need to customize `cv.yml` based on how you want to transform or present the CV content.
## Security Warning: Password Authentication

This project currently uses password authentication for Ansible to connect to the created DigitalOcean Droplet. The root password is set during Droplet creation and written directly into the generated `Ansible/inventory.ini` file in plain text.

**This approach carries significant security risks:**
* Storing passwords in plain text files, even temporary ones like `inventory.ini`, is highly insecure.
* Passwords might be exposed in build logs, Jenkins console output (if verbose), or accessible on the agent's file system during pipeline execution.

**It is strongly recommended to modify this setup to use SSH key authentication instead.** This involves:
1.  Ensuring you have an SSH key pair and adding the public key to your DigitalOcean account.
2.  Updating `digitalocean_droplet_setup.yml` to assign your public SSH key to the new Droplet during creation **instead** of setting a password.
3.  Updating the logic that generates `inventory.ini` to omit the `ansible_password` and potentially specify the private key file (`ansible_ssh_private_key_file`) if needed, or configure Jenkins/Ansible environment to use the appropriate key automatically.
 
*Note on `Ansible/inven.ini`:* This file is dynamically generated by the first stage of the pipeline. Because this setup uses password authentication, the file will contain the Droplet's IP address and plain text root password. **It is critical that `Ansible/inventory.ini` remains listed in your `.gitignore` file to prevent committing sensitive credentials.**
